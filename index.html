<!DOCTYPE html>
<html lang>
<head>
    <meta charset="UTF-8">
    <title>TranslationPlugin ❤️ Yii.Guxing</title>
    <link rel="icon" href="favicon.ico">
    <meta name="description" content="IntelliJ-based IDEs/Android Studio 翻译插件，支持多语言互译、文档翻译、语音朗读...">
    <meta name="keywords" content="IDEA Plugin,IDEA Translation Plugin,IDEA 插件,IDEA 翻译插件,插件">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="stylesheet" href="css/vue.css?v1.2">
    <link rel="stylesheet" href="css/app.css?v1.5">
</head>
<body>
<nav class="app-nav unselectable">
    <div class="left">
        <a id="nav-home" class="nav-logo" data-path="">
            <img src="img/logo.svg" width="40" height="40" alt="logo">
            <span>TranslationPlugin</span>
        </a>
        <a id="nav-docs" data-path="docs"><span
                lang="zh">文档</span><span
                lang="en">Docs</span><span
                lang="ja">ドキュメント</span><span
                lang="ko">문서</span></a>
        <a id="nav-updates" data-path="updates"><span
                lang="zh">更新</span><span
                lang="en">Updates</span><span
                lang="ja">更新</span><span
                lang="ko">업데이트</span></a>
        <a id="nav-support" data-path="support"><span
                lang="zh">支持与赞助</span><span
                lang="en">Support/Sponsor</span><span
                lang="ja">サポートとスポンサー</span><span
                lang="ko">지원 및 기부</span></a>
        <a id="nav-faq" data-path="faq"><span
                lang="zh">FAQ</span><span
                lang="en">FAQ</span><span
                lang="ja">FAQ</span><span
                lang="ko">FAQ</span></a>
    </div>

    <div class="nav-translation--wrapper">
        <a id="nav-translation" class="nav-icon-link nav-translations">
            <img src="img/translation.svg" width="22" height="22" alt="translations">
        </a>
        <div class="nav-translations--menu">
            <ul>
                <li><a id="translation-zh" lang="zh">简体中文</a></li>
                <li><a id="translation-en" lang="en">English</a></li>
                <li><a id="translation-jp" lang="ja">日本語</a></li>
                <li><a id="translation-ko" lang="ko">한국어</a></li>
            </ul>
            <div class="nav-translations--item-help">
                <a id="help-translate" href="https://github.com/YiiGuxing/TranslationPlugin/tree/pages-staging"
                   target="_blank">👋
                    <span lang="zh">帮助我们翻译！</span><span
                            lang="en">Help Us Translate!</span><span
                            lang="ja">翻訳にご協力ください！</span><span
                            lang="ko">번역을 도와주세요!</span></a>
            </div>
        </div>
    </div>

    <a id="nav-github" class="nav-icon-link" href="https://github.com/YiiGuxing/TranslationPlugin" target="_blank">
        <img src="img/github.svg" width="24" height="24" alt="github">
    </a>
</nav>
<div id="app"></div>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-RMH8BJ3BGP"></script>
<script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'G-RMH8BJ3BGP', {send_page_view: false});

    function gaPageView() {
        gtag('event', 'page_view', {
            page_path: window.location.hash,
            page_title: document.title
        });
    }
</script>
<script>
    LAST_PLUGIN_VERSION = "v3.6";

    function gaPlugin(hook) {
        hook.beforeEach(gaPageView);
    }

    function plugin(hook, vm) {
        hook.init(function () {
            vm.titles = {
                "docs": {
                    "/": "文档",
                    "/en/": "Documentation",
                    "/ja/": "ドキュメント",
                    "/ko/": "문서",
                },
                "updates": {
                    "/": "更新",
                    "/en/": "Updates",
                    "/ja/": "更新",
                    "/ko/": "업데이트",
                },
                "changelog": {
                    "/": "更新日志",
                    "/en/": "Changelog",
                    "/ja/": "更新ログ",
                    "/ko/": "변경 로그",
                },
                "support": {
                    "/": "支持与赞助",
                    "/en/": "Support/Sponsor",
                    "/ja/": "サポートとスポンサー",
                    "/ko/": "지원 및 기부",
                },
                "faq": {
                    "/": "FAQ",
                    "/en/": "FAQ",
                    "/ja/": "FAQ",
                    "/ko/": "FAQ",
                },
            };

            resetTitle(vm);
            initPlugin(vm);
        });

        hook.mounted(function () {
            if (window.$compactMode || vm.route.query.compact === "true") {
                vm.config.topMargin = 0;
                vm.config.hideSidebar = true;
                vm.customConfig.compact = true;
            }

            if (/^\/((en|ja|ko)\/)?$/.test(vm.route.path)) {
                gaPageView();
            }

            initNavBar(vm);
            updateSidebar(vm);
        });

        hook.beforeEach(function () {
            var title = getTitle(vm);
            vm.currentTitle = title;
            document.title = title;
        });

        hook.afterEach(function (html, next) {
            var output = resolveImagePathIfNeed(vm, html);
            output = resolveHeading(output);
            next(output);
        });

        hook.doneEach(function () {
            document.title = vm.currentTitle;
            updateLanguage(vm);
            updateNavBar(vm);
            updateSidebar(vm);
            startTyped();
        });
    }

    function initPlugin(vm) {
        var pathRegex = /^\/((en|ja|ko)\/)?/;
        Object.defineProperty(vm.config, "loadSidebar", {
            get: function () {
                var path = (vm.route.path || "").replace(pathRegex, "")
                if (!path || path === "docs" || path.indexOf("updates/") === 0) {
                    return "_sidebar.md"
                } else if (path === "updates") {
                    return "updates/_sidebar.md"
                }
                return false;
            }
        });

        vm.customConfig = {
            compact: false
        };
    }

    function getTitle(vm) {
        var title = "";
        var matchResults = /^(\/((en|ja|ko)\/)?)(docs|support|faq|(updates)(\/(v\d+\.\d+|changelog)?)?)$/.exec(vm.route.path);
        if (matchResults) {
            if (matchResults[7] === "changelog") {
                title = vm.titles.changelog[matchResults[1]];
            } else if (matchResults[7]) {
                title = matchResults[7];
            } else {
                title = (vm.titles[matchResults[5] || matchResults[4]] || {})[matchResults[1]];
            }
        }

        if (title) {
            title += " - ";
        }

        return title + "TranslationPlugin ❤️ Yii.Guxing";
    }

    function resetTitle(vm) {
        var title = "TranslationPlugin ❤️ Yii.Guxing";
        vm.currentTitle = title;
        document.title = title;
    }

    function initNavBar(vm) {
        initNavLinks(vm);
        initNavTranslations(vm);

        var nav = document.querySelector(".app-nav");
        if (nav && vm.customConfig.compact) {
            nav.classList.add("hide")
        }
    }

    function initNavLinks(vm) {
        var navLinks = document.querySelectorAll(".app-nav a[data-path]");
        for (var i = 0; i < navLinks.length; i++) {
            navLinks[i].onclick = function () {
                window.location.href = "#" + getLanguagePath(vm) + this.getAttribute("data-path");

                if (this.id === "nav-home") {
                    resetTitle(vm);
                    gaPageView();
                    setTimeout(function () {
                        document.scrollingElement.scrollTop = 0;
                    }, 0);
                }
            }
        }
    }

    function initNavTranslations(vm) {
        var translationLink = document.querySelector("#nav-translation");
        var menu = document.querySelector(".nav-translations--menu");
        if (translationLink && menu) {
            translationLink.onmousedown = function (e) {
                e.stopPropagation();
            };
            translationLink.onclick = function (e) {
                menu.classList.toggle("show");
            }

            var helpTranslate = document.querySelector("#help-translate");
            menu.onmousedown = function (e) {
                e.stopPropagation();
            };
            menu.onclick = function (e) {
                var isHelpTranslate = helpTranslate && helpTranslate.contains(e.target);
                var isLanguageLink = !isHelpTranslate && e.target.tagName === "A";
                if ((isHelpTranslate || isLanguageLink) && menu.classList.contains("show")) {
                    menu.classList.remove("show");
                }
                if (isLanguageLink) {
                    switchLanguage(vm, e.target.lang)
                }
            };
            document.addEventListener("mousedown", function () {
                if (menu.classList.contains("show")) {
                    menu.classList.remove("show");
                }
            });
        }
    }

    function updateNavBar(vm) {
        var navBar = document.querySelector("nav.app-nav");
        if (!navBar) {
            return;
        }

        var result = /^\/((en|ja|ko)\/)?(docs|updates|support|faq)/.exec(vm.route.path);
        navBar.setAttribute("data-path", result && result[3] || "");
    }

    function updateSidebar(vm) {
        var showSidebar = !vm.customConfig.compact && /^\/((en|ja|ko)\/)?(docs|updates(\/.*)?)?$/.test(vm.route.path);
        var main = document.querySelector("main");
        main && main.classList.toggle("hide-sidebar", !showSidebar);

        if (!showSidebar) {
            return;
        }

        var matchResults = /^\/((en|ja|ko)\/)?updates(\/(.+))?$/.exec(vm.route.path);
        if (!matchResults) {
            return;
        }

        var version = matchResults[4] || LAST_PLUGIN_VERSION;
        var versionItems = document.querySelectorAll(".sidebar-nav > ul > li");
        for (var i = 0; i < versionItems.length; i++) {
            versionItems[i].classList.toggle("active--imp", versionItems[i].innerText.startsWith(version));
        }
    }

    function updateLanguage(vm) {
        var result = /^\/((en|ja|ko)\/)?(.*)/.exec(vm.route.path);
        var lang = result && result[2] || "zh"
        document.documentElement.setAttribute("lang", lang);
    }

    function getLanguagePath(vm) {
        var result = /^(\/((en|ja|ko)\/)?)/.exec(vm.route.path);
        return result && result[0] || "/"
    }

    function switchLanguage(vm, newLanguage) {
        if (newLanguage) {
            var replacement = "/$4";
            if (newLanguage !== "zh") {
                replacement = "/" + newLanguage + replacement;
            }
            var newPath = vm.route.path.replace(/^(\/((en|ja|ko)\/)?)(.*)/, replacement);
            var query = ""
            for (const queryKey in vm.route.query) {
                if (query) {
                    query += "&"
                }
                query += queryKey + "=" + encodeURI(vm.route.query[queryKey] || "");
            }
            if (query) {
                query = "?" + query;
            }
            window.location.href = "#" + newPath + query;
        }
    }

    function resolveImagePathIfNeed(vm, html) {
        if (!html || !/^\/((en|ja|ko)\/)?updates(\/.*)?$/.test(vm.route.path)) {
            return html;
        }

        return html.replace(/<img src="(.+?)"(.*?)data-origin="(.+?)"(.*?)>/g, '<img src=".$3"$2$4>');
    }

    function resolveHeading(html) {
        if (!html) {
            return html;
        }

        try {
            var reg = /<(?<tag>h[1-6])(?<ha> .*?)??><a(?<aa> .*?)??>(?<txt>.*?)<\/a><\/\k<tag>>/g;
            return html.replace(reg, '<$<tag>$<ha>>$<txt><a$<aa>>#</a></$<tag>>');
        } catch (e) {
        }

        return html;
    }

    function startTyped() {
        window.typedInstances = window.typedInstances || [];
        window.typedInstances.forEach(function (typed) {
            typed.destroy();
        });

        window.typedInstances = [];
        document.querySelectorAll("[data-typed]").forEach(function (el) {
            if (!el.offsetParent) {
                return;
            }
            var target = el.dataset.typed;
            if (!target) {
                return;
            }
            window.typedInstances.push(new Typed(el, {
                stringsElement: '[data-typed-target="' + target + '"]',
                typeSpeed: 60,
                backSpeed: 10,
                cursorChar: '_',
                smartBackspace: true,
                loop: true,
            }));
        });
    }

    window.$docsify = {
        // name: "TranslationPlugin",
        onlyCover: true,
        auto2top: true,
        relativePath: true,
        executeScript: true,
        loadSidebar: false,
        maxLevel: 3,
        topMargin: 60,
        plugins: [plugin, gaPlugin],
        coverpage: ['/', '/en/', '/ja/', '/ko/'],
        fallbackLanguages: ['en', 'ja', 'ko'],
        nameLink: {
            '/en/': '#/en/',
            '/ja/': '#/ja/',
            '/ko/': '#/ko/',
            '/': '#/',
        },
        alias: {
            "((/(en|ja|ko))?)/docs": "$1/",
            "((/(en|ja|ko))?)/updates(/?)": "$1/updates/" + LAST_PLUGIN_VERSION,
            "((/(en|ja|ko))?)/updates/updates/_sidebar.md": "$1/updates/_sidebar.md",
        },
    };

    function checkCompactMode(search) {
        if (search) {
            var searchParams = new URLSearchParams(search);
            return searchParams.get('compact') === 'true';
        } else {
            return false;
        }
    }

    (function () {
        var compactMode = checkCompactMode(window.location.search) ||
            checkCompactMode(window.location.hash.split("?")[1]);
        if (compactMode) {
            window.$compactMode = true;
            var nav = document.querySelector(".app-nav");
            nav && nav.classList.add("hide");
        }
    })();
</script>
<script src="js/typed@2.1.0.umd.js"></script>
<!-- Docsify v4 -->
<script src="js/docsify@4.13.1-cover-lifecycle.min.js"></script>
<script src="js/external-script.min.js"></script>
</body>
</html>
